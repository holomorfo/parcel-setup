"use strict";const MSG_LEVELS=["DEBUG","INFO","WARN","ERROR"],DEFAULT_i18n_DATA_ATTR="vanilla-i18n",DEFAULT_i18n_DIR="assets/vanilla-i18n",DEFAULT_LANG_TOGGLER_ID="vanilla-i18n-toggler";class vanilla_i18n{constructor(a,b){this._languages=a,this._path=this._sanitizePath(b.path||DEFAULT_i18n_DIR),this._debug=b.debug||!1,this._i18nDataAttr=b.i18n_attr_name||DEFAULT_i18n_DATA_ATTR,this._localStorageKey=this._generateKeyFromHost(),this._togglerID=b.toggler_id||DEFAULT_LANG_TOGGLER_ID,b.default_language||(b.default_language=this._languages[0]),!this._getLanguage()&&b.default_language&&this._setSavedLanguage(b.default_language),document.addEventListener("DOMContentLoaded",()=>{this._attachOnChangeToi18nToggler(this._togglerID)})}async run(){const a=this._getLanguage();if(a&&!this._languages.includes(a))return void this._printMsg(`unsupported ${a} language found in local storage, supported languages are ${this._languages}`,MSG_LEVELS[3]);if(!a)return void this._printMsg(`no set language found, default language will be used`,MSG_LEVELS[2]);document.addEventListener("DOMContentLoaded",()=>{this._setTogglerValue(a,this._togglerID)});const b=await this._loadLangFile(a);if(!b)return void this._printMsg(`failed to load translation file for ${a}`,MSG_LEVELS[3]);const c=this._getElementsForTranslation();return c?void(this._translate(c,b),this._printMsg(`translation to ${a} finished for ${c.length} elements`,MSG_LEVELS[0])):void this._printMsg(`no element found for translating`,MSG_LEVELS[2])}_runOnChange(a){if(!this._languages.includes(a))return void this._printMsg(`${a} is not supported, supported languages are ${this._languages}`,MSG_LEVELS[3]);const b=this._getLanguage();a==b?this._printMsg(`selected language is same as current language`,MSG_LEVELS[0]):(this._printMsg(`switching to ${a} from ${b}`,MSG_LEVELS[1]),this._setSavedLanguage(a),this.run())}_attachOnChangeToi18nToggler(a){const b=document.getElementById(a);b?b.addEventListener("change",a=>{this._runOnChange(a.target.value)}):this._printMsg(`no language toggler found with id "${a}" for attaching onChange event`,MSG_LEVELS[2])}_setTogglerValue(a,b){const c=document.getElementById(b);c?(c.value=a,c.dispatchEvent(new Event("change"))):this._printMsg(`no language toggler found with id "${b}" for setting value`,MSG_LEVELS[2])}_translate(a,b=void 0){b&&a.forEach(a=>{var c=a.getAttribute(this._i18nDataAttr).split("."),d=c.reduce((a,b)=>a[b],b);d&&(a.innerHTML=d)})}_getElementsForTranslation(){return document.querySelectorAll("["+this._i18nDataAttr+"]")}async _loadLangFile(a=void 0){if(a){const c=`/${this._path}/${a}.json`;try{var b=await fetch(c);return b.json()}catch{}}}_getLanguage(){var a=this._getSavedLanguage();return a||this._printMsg("no saved language found, default language will load",MSG_LEVELS[0]),a}_getSavedLanguage(){return window.localStorage.getItem(this._localStorageKey)}_setSavedLanguage(a){a&&window.localStorage.setItem(this._localStorageKey,a)}_generateKeyFromHost(){return window.location.host+"-vanilla-i18n"}_sanitizePath(a){return a=a.trim(),"/"===a[0]&&(a=a.slice(1,a.length)),"/"===a[a.length-1]&&(a=a.slice(0,-1)),a}_printMsg(a,b){(b!==MSG_LEVELS[0]||this._debug)&&console.info("vanilla-i18n | "+b+":"+a)}}